{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}ZakirShop{% endblock %}</title>

    <!-- Mobile responsive -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Main stylesheet -->
    <link rel="stylesheet" href="{% static 'store/styles.css' %}">

    {% block extra_head %}{% endblock %}
</head>

<body>
    {% with request.resolver_match.url_name as url_name %}

    <!-- ================= HEADER ================ -->
    <header class="site-header">
        <!-- Logo / Brand -->
        <a href="{% url 'home' %}" class="logo">
            ğŸ›’ ZakirShop
        </a>

        <nav class="main-nav">
            <!-- LEFT SIDE: main links + dropdowns -->
            <ul class="nav-left">
                <li class="nav-item">
                    <a href="{% url 'home' %}"
                    class="nav-link {% if url_name == 'home' %}active{% endif %}">
                        ğŸ  Home
                    </a>
                </li>

                <li class="nav-item">
                    <a href="{% url 'product_list' %}"
                    class="nav-link {% if url_name == 'product_list' %}active{% endif %}">
                        ğŸ“¦ Products
                    </a>
                </li>

                <!-- ğŸ”½ CATEGORIES DROPDOWN -->
                <li class="nav-item profile-menu has-dropdown">
                    <button class="profile-toggle dropdown-toggle" type="button">
                        ğŸ“‚ Categories â–¾
                    </button>
                    <div class="profile-dropdown brand-dropdown">
                        {% for category in all_categories %}
                            <a href="{% url 'product_list' %}?category={{ category.slug }}"
                            class="brand-item">
                                {% if category.image %}
                                    <img src="{{ category.image.url }}"
                                        alt="{{ category.name }}"
                                        class="brand-thumb">
                                {% else %}
                                    <img src="{% static 'images/category-default.png' %}"
                                        alt="{{ category.name }}"
                                        class="brand-thumb">
                                {% endif %}
                                <span>{{ category.name }}</span>
                            </a>
                        {% endfor %}
                    </div>
                </li>

                <!-- ğŸ”½ BRANDS DROPDOWN -->
                <li class="nav-item profile-menu has-dropdown">
                    <button class="profile-toggle dropdown-toggle" type="button">
                        ğŸ·ï¸ Brands â–¾
                    </button>
                    <div class="profile-dropdown brand-dropdown">
                        {% for brand in all_brands %}
                            <a href="{% url 'brand_products' brand.slug %}" class="brand-item">
                                {% if brand.image and brand.image.name %}
                                    <img src="{{ brand.image.url }}" alt="{{ brand.name }}" class="brand-thumb">
                                {% else %}
                                    <img src="{% static 'images/default-brand.png' %}" class="brand-thumb" alt="{{ brand.name }}">
                                {% endif %}
                                <span>{{ brand.name }}</span>
                            </a>
                        {% endfor %}
                    </div>
                </li>
            </ul>

            <!-- RIGHT SIDE: cart + admin + user / auth -->
            <ul class="nav-right">
                {% if request.user.is_authenticated %}
                    <!-- Cart -->
                    <li class="nav-item">
                        <a href="{% url 'cart_detail' %}"
                        class="nav-link nav-cart {% if url_name == 'cart_detail' %}active{% endif %}">
                            ğŸ›’ Cart
                            {% if cart_item_count %}
                                <span class="cart-badge">{{ cart_item_count }}</span>
                            {% endif %}
                        </a>
                    </li>

                    <!-- Admin dropdown (if staff) -->
                    {% if request.user.is_staff %}
                        <li class="nav-item profile-menu has-dropdown">
                            <button class="profile-toggle dropdown-toggle" type="button">
                                ğŸ›  Admin â–¾
                            </button>
                            <div class="profile-dropdown">
                                <a href="{% url 'product_create' %}">â• Add Product</a>
                                <a href="{% url 'product_list' %}">âœï¸ Edit Products</a>
                                <a href="{% url 'bulk_upload' %}">ğŸ“¤ Bulk Upload</a>
                                <a href="{% url 'product_delete_list' %}">ğŸ—‘ï¸ Delete Products</a>
                                <a href="{% url 'order_list' %}">ğŸ§¾ Manage Orders</a>
                            </div>
                        </li>
                    {% endif %}

                    <!-- User dropdown -->
                    <li class="nav-item profile-menu has-dropdown">
                        <button class="profile-toggle dropdown-toggle" type="button">
                            ğŸ‘¤ {{ request.user.username }} â–¾
                        </button>
                        <div class="profile-dropdown">
                            <a href="{% url 'profile' %}">ğŸ™â€â™‚ï¸ My Profile</a>
                            <a href="{% url 'my_orders' %}">ğŸ“¦ My Orders</a>
                            <a href="{% url 'dashboard' %}">ğŸ“Š Dashboard</a>
                            <a href="{% url 'logout' %}">ğŸšª Logout</a>
                        </div>
                    </li>

                {% else %}
                    <!-- Guest links -->
                    <li class="nav-item">
                        <a href="{% url 'login' %}"
                        class="nav-link {% if url_name == 'login' %}active{% endif %}">
                            ğŸ”‘ Login
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="{% url 'register' %}"
                        class="nav-link {% if url_name == 'register' %}active{% endif %}">
                            âœï¸ Register
                        </a>
                    </li>
                {% endif %}
            </ul>
        </nav>
    </header>

    <!-- ================= MESSAGES ================ -->
    {% if messages %}
        <div class="messages">
            {% for message in messages %}
                <div class="message {{ message.tags }}">{{ message }}</div>
            {% endfor %}
        </div>
    {% endif %}

    <!-- ================= MAIN CONTENT ================ -->
    <main class="site-main">
        {% block content %}{% endblock %}
    </main>

    <!-- ================= FOOTER ================ -->
    <footer class="site-footer">
        &copy; {% now "Y" %} ZakirShop.com â€¢ ğŸ›ï¸ Happy Shopping
    </footer>

    <!-- âœ… Mobile Bottom Nav (like screenshot) -->
    <nav class="mobile-bottom-nav">
        <a href="{% url 'home' %}" class="mbn-item {% if url_name == 'home' %}active{% endif %}">
            <span class="mbn-icon">ğŸ </span>
            <span class="mbn-text">Home</span>
        </a>

        <a href="{% url 'product_list' %}" class="mbn-item {% if url_name == 'product_list' %}active{% endif %}">
            <span class="mbn-icon">ğŸ“‚</span>
            <span class="mbn-text">Categories</span>
        </a>

        <a href="{% url 'cart_detail' %}" class="mbn-item {% if url_name == 'cart_detail' %}active{% endif %}">
            <span class="mbn-icon">ğŸ›’</span>
            <span class="mbn-text">Cart</span>
            {% if cart_item_count %}
                <span class="mbn-badge">{{ cart_item_count }}</span>
            {% endif %}
        </a>

        {% if request.user.is_authenticated %}
            <a href="{% url 'my_orders' %}" class="mbn-item {% if url_name == 'my_orders' %}active{% endif %}">
                <span class="mbn-icon">â¤ï¸</span>
                <span class="mbn-text">My List</span>
            </a>

            <a href="{% url 'profile' %}" class="mbn-item {% if url_name == 'profile' %}active{% endif %}">
                <span class="mbn-icon">ğŸ‘¤</span>
                <span class="mbn-text">My Account</span>
            </a>
        {% else %}
            <a href="{% url 'login' %}" class="mbn-item {% if url_name == 'login' %}active{% endif %}">
                <span class="mbn-icon">ğŸ‘¤</span>
                <span class="mbn-text">Account</span>
            </a>
        {% endif %}
    </nav>

    {% block extra_scripts %}{% endblock %}

    {% endwith %}
</body>
</html>
